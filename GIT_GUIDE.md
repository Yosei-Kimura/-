# Git設定とファイル管理ガイド

## .gitignore について

このプロジェクトの `.gitignore` は以下の方針で設定されています：

### 🔐 セキュリティファイルの除外
- **環境設定ファイル** (`.env`, `.env.*`) - 認証情報を含むため
- **データベース設定** - 本番環境の認証情報を含むため
- **証明書・キー** - セキュリティキーやSSL証明書

### 📊 ログファイルの除外
- **アプリケーションログ** - システム動作ログ
- **エラーログ** - PHPエラー、Webサーバーエラー
- **一時ファイル** - キャッシュ、セッション情報

### 💾 データファイルの除外
- **データベースファイル** - SQLite、バックアップファイル
- **アップロードファイル** - ユーザーがアップロードしたファイル
- **エクスポートデータ** - 棚卸結果のCSV、Excel

### 🛠️ 開発環境ファイルの除外
- **IDE設定** - VS Code、PhpStorm設定
- **OS固有ファイル** - .DS_Store、Thumbs.db
- **一時ファイル** - エディタの一時ファイル

## ファイル追跡の例外

以下のファイルは例外的に追跡されます：

```
!.env.example          # 設定テンプレート
!sample/              # サンプルファイル
!README.md            # ドキュメント
!config/*.template.php # 設定テンプレート
```

## 新しい環境でのセットアップ

1. リポジトリをクローン
2. `.env.example` を `.env` にコピー
3. `.env` ファイルを実際の環境に合わせて編集
4. データベース設定を確認

```bash
# セットアップ例
cp .env.example .env
# .env ファイルを編集
nano .env
```

## 注意事項

### ⚠️ 絶対にコミットしてはいけないファイル
- `.env` ファイル（実際の認証情報を含む）
- `logs/` ディレクトリのログファイル
- `backup/` ディレクトリのデータベースバックアップ
- 個人の開発設定ファイル

### ✅ コミットするべきファイル
- `.env.example` （認証情報を除いたテンプレート）
- ソースコード（`.php`, `.html`, `.css`, `.js`）
- 設定ファイル（認証情報を除く）
- ドキュメント（`README.md`, `*.md`）

## トラブルシューティング

### 既に追跡されているファイルを除外する場合

```bash
# キャッシュから削除（ファイルは残る）
git rm --cached filename

# .gitignore に追加
echo "filename" >> .gitignore

# 変更をコミット
git add .gitignore
git commit -m "Add filename to .gitignore"
```

### 誤ってコミットしてしまった機密ファイルがある場合

```bash
# 履歴からも完全に削除（注意：強制プッシュが必要）
git filter-branch --force --index-filter 'git rm --cached --ignore-unmatch .env' --prune-empty --tag-name-filter cat -- --all
```

**⚠️ 警告**: 上記コマンドは履歴を書き換えるため、チーム開発では慎重に実行してください。

## 定期メンテナンス

### ログファイルのクリーンアップ
```bash
# 古いログファイルを削除（7日以上前）
find logs/ -name "*.log" -mtime +7 -delete
```

### 一時ファイルのクリーンアップ
```bash
# 一時ファイルを削除
rm -rf tmp/* temp/* cache/*
```